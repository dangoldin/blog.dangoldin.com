<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Redirect recursion - Dan Goldin</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=referrer content="no-referrer"><meta name=description content="I've stumbled unto a way of doing recursion using a series of redirects. I can't think of a real use case but it's one of those fun hacks that's interesting to see."><meta property="og:site_name" content="Dan Goldin"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="/2014/12/31/redirect-recursion/"><meta property="og:title" content="Redirect recursion"><meta property="og:image" content="/image/photo.jpg"><meta property="og:description" content="I've stumbled unto a way of doing recursion using a series of redirects. I can't think of a real use case but it's one of those fun hacks that's interesting to see."><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@dangoldin"><meta name=twitter:creator content="@dangoldin"><meta name=twitter:title content="Redirect recursion"><meta name=twitter:description content="I've stumbled unto a way of doing recursion using a series of redirects. I can't think of a real use case but it's one of those fun hacks that's interesting to see."><meta name=twitter:image content="/image/photo.jpg"><link rel=canonical href=/2014/12/31/redirect-recursion/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin=anonymous><link rel=stylesheet href=https://nanx-assets.netlify.app/fonts.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github-gist.min.css integrity="sha512-od7JLoOTxM8w/HSKGzP9Kexc20K9p/M2zxSWsd7H1e4Ctf+8SQFtCWEZnW5u6ul5ehSECa5QmOk9ju2nQMmlVA==" crossorigin=anonymous><link rel="shortcut icon" href=image/favicon.png><link href=/index.xml rel=alternate type=application/rss+xml title="Dan Goldin"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-36313127-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-36313127-1');</script></head><body><div class="my-4 my-lg-5 header"><div class=container><div class=row><div class="col-auto offset-lg-2 d-none d-lg-block"><a href=/><img class="ml-lg-4 logo img-fluid d-block rounded-circle" src=/image/photo.jpg alt=logo></a></div><div class="col-auto align-self-center mr-auto"><a href=/><h1 class=name>Dan Goldin</h1></a><ul class="nav nav-primary"><li class=nav-item><a class="nav-link text-home" href=/>Home</a></li><li class=nav-item><a class="nav-link text-about" href=/about/>About</a></li><li class=nav-item><a class="nav-link text-lore" href=/lore/>Lore</a></li></ul></div></div></div></div><div class=content><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><h1 class="mx-0 mx-md-4 blog-post-title">Redirect recursion</h1><div class="mb-md-4 meta"><span class="date middot" title="Wed Dec 31 2014 00:00:00 UTC">2014-12-31</span>
<span class="reading-time middot">2 min read</span><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"><li class="d-inline middot"><a href=/tags/code>code</a></li><li class="d-inline middot"><a href=/tags/javascript>javascript</a></li></ul></div><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"></ul></div></div><div class="markdown blog-post-content"><p>I’ve stumbled onto what seems to be a solution without a problem but something that’s been fun to experiment with and might have an actual application. The idea is to replace a recursion step with a URL redirection. In this situation the base case will return a 200 response while the recursive step will do a redirection with a slightly updated URL. The sample node server below uses this idea to handle a three tasks - sum up to n, compute a factorial, and test whether an integer is prime.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>express</span>  <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;express&#39;</span>),
    <span style=color:#a6e22e>port</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4000</span>;

<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>express</span>();

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/sum&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>) {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>param</span>(<span style=color:#e6db74>&#39;n&#39;</span>),<span style=color:#ae81ff>10</span>) <span style=color:#f92672>||</span> <span style=color:#ae81ff>0</span>,
      <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>param</span>(<span style=color:#e6db74>&#39;a&#39;</span>),<span style=color:#ae81ff>10</span>) <span style=color:#f92672>||</span> <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>n</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>200</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#39;Sum: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>a</span>);
  } <span style=color:#66d9ef>else</span> {
      <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/sum?n=&#34;</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&amp;a=&#34;</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>a</span><span style=color:#f92672>+</span><span style=color:#a6e22e>n</span>);
      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>redirect</span>(<span style=color:#a6e22e>url</span>);
  }
});

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/fact&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>) {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>param</span>(<span style=color:#e6db74>&#39;n&#39;</span>),<span style=color:#ae81ff>10</span>) <span style=color:#f92672>||</span> <span style=color:#ae81ff>1</span>,
          <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>param</span>(<span style=color:#e6db74>&#39;a&#39;</span>),<span style=color:#ae81ff>10</span>) <span style=color:#f92672>||</span> <span style=color:#ae81ff>1</span>;
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>n</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span>) {
      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>200</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#39;Factorial: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>a</span>);
  } <span style=color:#66d9ef>else</span> {
      <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/fact?n=&#34;</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&amp;a=&#34;</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>a</span><span style=color:#f92672>*</span><span style=color:#a6e22e>n</span>);
      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>redirect</span>(<span style=color:#a6e22e>url</span>);
  }
});

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/isPrime&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>) {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>param</span>(<span style=color:#e6db74>&#39;n&#39;</span>),<span style=color:#ae81ff>10</span>),
      <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>param</span>(<span style=color:#e6db74>&#39;f&#39;</span>),<span style=color:#ae81ff>10</span>) <span style=color:#f92672>||</span> <span style=color:#ae81ff>2</span>;
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>f</span> <span style=color:#f92672>&gt;</span> Math.<span style=color:#a6e22e>sqrt</span>(<span style=color:#a6e22e>n</span>)) {
      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>200</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#39;Prime&#39;</span>);
  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>n</span> <span style=color:#f92672>%</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>200</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#39;Composite&#39;</span>);
  } <span style=color:#66d9ef>else</span> {
      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>redirect</span>(<span style=color:#e6db74>&#39;/isPrime?n=&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&amp;f=&#39;</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>f</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>));
  }
});

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>listen</span>(<span style=color:#a6e22e>port</span>);
<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Server started on port &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>port</span>);
</code></pre></div><p>The only cases I can think of where it’s even remotely useful is if your servers are behind a CDN and you want to cache every intermediate result without having to write the application logic to do it or you need to reduce the amount of work done by a single HTTP request. It’s just not an efficient approach otherwise - the overhead of making new HTTP connections and handling arguments for every recursive step is usually more expensive than doing the actual logic within a single request.</p><p>The other use case I can think of is purely educational - it forces you to write your recursive code in a tail recursive style and forces you to think about the state you need to share between redirect requests. And if you’re ever told to solve a problem without using for loops or recursion you can violate the spirit of the request by using a series of HTTP redirects.</p><p>I’m genuinely curious if there’s an actual use case for this and whether anyone’s had to do this.</p></div><div class=navigation><div class=row><div class="col-12 col-lg-6"><div class="mx-0 mx-md-4 mt-4 text-left"><a href=/2014/12/29/a-new-turing-test/>« A new Turing test</a></div></div><div class="col-12 col-lg-6"><div class="mx-0 mx-md-4 mt-4 text-right"><a href=/2015/01/04/introducing-jsonify.me/>Introducing jsonify.me »</a></div></div></div></div></div></div></div></div><section id=comments><div class="py-3 content"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><div class=comments><script src=https://utteranc.es/client.js repo=dangoldin/blog.dangoldin.com-comments issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></div></div></div></div></div></section><div class="my-4 footer"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><hr></div></div><div class="row justify-content-center"><div class="col-sm-12 col-lg-2"><div class="mx-0 mx-md-4 site-copyright">© 2021 Dan Goldin</div></div><div class="col-sm-12 col-lg-6"><div class="mx-0 mx-md-4 site-social"><ul><li><a href=mailto:dan@dangoldin.com>Contact</a></li><li><a href=https://github.com/dangoldin target=_blank>GitHub</a></li><li><a href=https://twitter.com/dangoldin target=_blank>Twitter</a></li><li><a href=https://www.linkedin.com/in/dangoldin target=_blank>LinkedIn</a></li><li><a href=/index.xml class=mr-0>RSS</a></li></ul></div></div></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js defer></script><script>window.addEventListener('load',function(){hljs.initHighlighting();},true);</script></body></html>