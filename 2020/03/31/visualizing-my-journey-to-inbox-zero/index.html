<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Visualizing my journey to Inbox Zero - Dan Goldin</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=referrer content="no-referrer"><meta name=description content="In my pursuit of quantifying more and more I now have a dashboard that tracks the amount of messages in my email inbox."><meta property="og:site_name" content="Dan Goldin"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="/2020/03/31/visualizing-my-journey-to-inbox-zero/"><meta property="og:title" content="Visualizing my journey to Inbox Zero"><meta property="og:image" content="//image/grafana-emails-in-inbox.png"><meta property="og:description" content="In my pursuit of quantifying more and more I now have a dashboard that tracks the amount of messages in my email inbox."><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@dangoldin"><meta name=twitter:creator content="@dangoldin"><meta name=twitter:title content="Visualizing my journey to Inbox Zero"><meta name=twitter:description content="In my pursuit of quantifying more and more I now have a dashboard that tracks the amount of messages in my email inbox."><meta name=twitter:image content="//image/grafana-emails-in-inbox.png"><link rel=canonical href=/2020/03/31/visualizing-my-journey-to-inbox-zero/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin=anonymous><link rel=stylesheet href=https://nanx-assets.netlify.app/fonts.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github-gist.min.css integrity="sha512-od7JLoOTxM8w/HSKGzP9Kexc20K9p/M2zxSWsd7H1e4Ctf+8SQFtCWEZnW5u6ul5ehSECa5QmOk9ju2nQMmlVA==" crossorigin=anonymous><link rel="shortcut icon" href=image/favicon.png><link href=/index.xml rel=alternate type=application/rss+xml title="Dan Goldin"></head><body><div class="my-4 my-lg-5 header"><div class=container><div class=row><div class="col-auto offset-lg-2 d-none d-lg-block"><a href=/><img class="ml-lg-4 logo img-fluid d-block rounded-circle" src=/image/photo.jpg alt=logo></a></div><div class="col-auto align-self-center mr-auto"><a href=/><h1 class=name>Dan Goldin</h1></a><ul class="nav nav-primary"><li class=nav-item><a class="nav-link text-home" href=/>Home</a></li><li class=nav-item><a class="nav-link text-about" href=/about/>About</a></li><li class=nav-item><a class="nav-link text-lore" href=/lore/>Lore</a></li></ul></div></div></div></div><div class=content><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><h1 class="mx-0 mx-md-4 blog-post-title">Visualizing my journey to Inbox Zero</h1><div class="mb-md-4 meta"><span class="date middot" title="Tue Mar 31 2020 00:00:00 UTC">2020-03-31</span>
<span class="reading-time middot">2 min read</span><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"><li class="d-inline middot"><a href=/tags/code>code</a></li><li class="d-inline middot"><a href=/tags/dataviz>dataviz</a></li></ul></div><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"></ul></div></div><div class="markdown blog-post-content"><p><img src=/image/grafana-emails-in-inbox.png alt="Number of emails in my inbox by account" data-width=1855 data-height=518 data-layout=responsive></p><p>I subscribe to the &ldquo;Inbox Zero&rdquo; philosophy and treat my email inbox as a todo list that I slowly work through. As part of the desire to get more and more quantitative I wrote a quick script to pull the number of emails from my Inbox and then insert the data as a row into a new table in my personal stats database. As usual, most of the work was in deciding to do it and once I got to coding the hacky solution was done within 20 minutes. The script uses Python&rsquo;s built-in <a href=https://docs.python.org/3/library/imaplib.html>imaplib</a> library to log in to an email provider and then a simple MySQL query to insert the resulting data. I hooked this up to run every 15 minutes via cron and put together a Grafana dashboard to plot the count over time. I&rsquo;m currently not actually going through the content of the email messages themselves but there are tons of directions I can take this - for example slicing the data by sender or examining the age of the messages. For now I&rsquo;m just hopeful this motivates me to keep going through that email.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#! /usr/bin/python3</span>

<span style=color:#f92672>import</span> imaplib
<span style=color:#f92672>import</span> mysql.connector

<span style=color:#75715e># TODO: Handle credentials better (environment, config, etc)</span>
IMAP_INFO <span style=color:#f92672>=</span> {
    <span style=color:#e6db74>&#39;work&#39;</span>: {
        <span style=color:#e6db74>&#39;imap_host&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
        <span style=color:#e6db74>&#39;imap_port&#39;</span>: <span style=color:#ae81ff>993</span>,
        <span style=color:#e6db74>&#39;imap_user&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
        <span style=color:#e6db74>&#39;imap_pass&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
    },
    <span style=color:#e6db74>&#39;personal&#39;</span>: {
        <span style=color:#e6db74>&#39;imap_host&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
        <span style=color:#e6db74>&#39;imap_port&#39;</span>: <span style=color:#ae81ff>993</span>,
        <span style=color:#e6db74>&#39;imap_user&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
        <span style=color:#e6db74>&#39;imap_pass&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
    },
}

db_host <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
db_user <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
db_pass <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
db_database <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_num_emails</span>(creds):
    imap <span style=color:#f92672>=</span> imaplib<span style=color:#f92672>.</span>IMAP4_SSL(creds[<span style=color:#e6db74>&#39;imap_host&#39;</span>], creds[<span style=color:#e6db74>&#39;imap_port&#39;</span>])
    imap<span style=color:#f92672>.</span>login(creds[<span style=color:#e6db74>&#39;imap_user&#39;</span>], creds[<span style=color:#e6db74>&#39;imap_pass&#39;</span>])
    imap<span style=color:#f92672>.</span>select(<span style=color:#e6db74>&#39;Inbox&#39;</span>)
    tmp, data <span style=color:#f92672>=</span> imap<span style=color:#f92672>.</span>search(None, <span style=color:#e6db74>&#39;ALL&#39;</span>)
    <span style=color:#66d9ef>return</span> len(data[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>split())

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>save_stats</span>(account_name, num_emails):
    mydb <span style=color:#f92672>=</span> mysql<span style=color:#f92672>.</span>connector<span style=color:#f92672>.</span>connect(
        host <span style=color:#f92672>=</span> db_host,
        user <span style=color:#f92672>=</span> db_user,
        passwd <span style=color:#f92672>=</span> db_pass,
        database <span style=color:#f92672>=</span> db_database,
    )
    mycursor <span style=color:#f92672>=</span> mydb<span style=color:#f92672>.</span>cursor()

    sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;INSERT INTO email_stats (account_name, num_emails) VALUES (</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>, </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>)&#34;</span>
    val <span style=color:#f92672>=</span> (account_name, num_emails)
    mycursor<span style=color:#f92672>.</span>execute(sql, val)
    mydb<span style=color:#f92672>.</span>commit()
    <span style=color:#66d9ef>print</span>(mycursor<span style=color:#f92672>.</span>rowcount, <span style=color:#e6db74>&#34;record inserted.&#34;</span>)

<span style=color:#66d9ef>for</span> account_name, creds <span style=color:#f92672>in</span> IMAP_INFO<span style=color:#f92672>.</span>items():
    num_emails <span style=color:#f92672>=</span> get_num_emails(creds)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#39;Fetched&#39;</span>, num_emails, <span style=color:#e6db74>&#39;in&#39;</span>, account_name)
    save_stats(account_name, num_emails)</code></pre></div></div><div class=navigation><div class=row><div class="col-12 col-lg-6"><div class="mx-0 mx-md-4 mt-4 text-left"><a href=/2020/03/29/a-tiktok-experience-for-streaming-services/>« A TikTok experience for streaming services</a></div></div><div class="col-12 col-lg-6"><div class="mx-0 mx-md-4 mt-4 text-right"><a href=/2020/04/04/finding-the-truth-in-a-sea-of-misinformation/>Finding the truth in a sea of misinformation »</a></div></div></div></div></div></div></div></div><section id=comments><div class="py-3 content"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><div class=comments><script src=https://utteranc.es/client.js repo=dangoldin/blog.dangoldin.com-comments issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></div></div></div></div></div></section><div class="my-4 footer"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><hr></div></div><div class="row justify-content-center"><div class="col-sm-12 col-lg-2"><div class="mx-0 mx-md-4 site-copyright">© 2021 Dan Goldin</div></div><div class="col-sm-12 col-lg-6"><div class="mx-0 mx-md-4 site-social"><ul><li><a href=mailto:dan@dangoldin.com>Contact</a></li><li><a href=https://github.com/dangoldin target=_blank>GitHub</a></li><li><a href=https://twitter.com/dangoldin target=_blank>Twitter</a></li><li><a href=https://www.linkedin.com/in/dangoldin target=_blank>LinkedIn</a></li><li><a href=/index.xml class=mr-0>RSS</a></li></ul></div></div></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js defer></script><script>window.addEventListener('load',function(){hljs.initHighlighting();},true);</script></body></html>