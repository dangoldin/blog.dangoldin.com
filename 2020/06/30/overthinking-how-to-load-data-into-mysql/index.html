<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Overthinking how to load data into MySQL - Dan Goldin</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=referrer content="no-referrer"><meta name=description content="I have two scripts to laod data into MySQL and while the end goals are similar they each take a different approach and it's not obvious which one is the more correct one."><meta property="og:site_name" content="Dan Goldin"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="/2020/06/30/overthinking-how-to-load-data-into-mysql/"><meta property="og:title" content="Overthinking how to load data into MySQL"><meta property="og:image" content="/image/photo.jpg"><meta property="og:description" content="I have two scripts to laod data into MySQL and while the end goals are similar they each take a different approach and it's not obvious which one is the more correct one."><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@dangoldin"><meta name=twitter:creator content="@dangoldin"><meta name=twitter:title content="Overthinking how to load data into MySQL"><meta name=twitter:description content="I have two scripts to laod data into MySQL and while the end goals are similar they each take a different approach and it's not obvious which one is the more correct one."><meta name=twitter:image content="/image/photo.jpg"><link rel=canonical href=/2020/06/30/overthinking-how-to-load-data-into-mysql/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin=anonymous><link rel=stylesheet href=https://nanx-assets.netlify.app/fonts.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github-gist.min.css integrity="sha512-od7JLoOTxM8w/HSKGzP9Kexc20K9p/M2zxSWsd7H1e4Ctf+8SQFtCWEZnW5u6ul5ehSECa5QmOk9ju2nQMmlVA==" crossorigin=anonymous><link rel="shortcut icon" href=/favicon.png><link href=/index.xml rel=alternate type=application/rss+xml title="Dan Goldin"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-36313127-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-36313127-1');</script></head><body><div class="my-4 my-lg-5 header"><div class=container><div class=row><div class="col-auto offset-lg-2 d-none d-lg-block"><a href=/><img class="ml-lg-4 logo img-fluid d-block rounded-circle" src=/image/photo.jpg alt=logo></a></div><div class="col-auto align-self-center mr-auto"><a href=/><h1 class=name>Dan Goldin</h1></a><ul class="nav nav-primary"><li class=nav-item><a class="nav-link text-home" href=/>Home</a></li><li class=nav-item><a class="nav-link text-about" href=/about/>About</a></li><li class=nav-item><a class="nav-link text-lore" href=/lore/>Lore</a></li></ul></div></div></div></div><div class=content><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><h1 class="mx-0 mx-md-4 blog-post-title">Overthinking how to load data into MySQL</h1><div class="mb-md-4 meta"><span class="date middot" title="Tue Jun 30 2020 00:00:00 UTC">2020-06-30</span>
<span class="reading-time middot">2 min read</span><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"><li class="d-inline middot"><a href=/tags/code>code</a></li></ul></div><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"></ul></div></div><div class="markdown blog-post-content"><p>I have two projects that generate data to dump into my <a href=/2020/02/27/my-personal-grafana-dashboard/>personal dashboard</a>. One <a href=https://github.com/dangoldin/health-stats>loads the health export</a> from my Apple watch into MySQL and the other <a href=https://github.com/dangoldin/blog-analytics>analyzes my blog posts</a> and generates a CSV file of statistics that I then load into MySQL. The input to both is basically the same - either a file or a directory - and yet two different approaches to the processing.</p><p>The blog analytics script doesn&rsquo;t depend on any third party libraries and just generates a CSV file that can then be loaded into MySQL through a query. The health stats script, on the other hand, connects to MySQL and handles the insertions incrementally. As you can guess the health script depends on an external library to make the connection to MySQL as well as a small library to handle some time zone logic.</p><p>I subscribe to the Unix philosophy of having programs do one thing but do it well. The first program follows this model. Yet it&rsquo;s less functional than the latter, it has no support for incremental logic and I have to run a separate SQL command to load the CSV file. The second program, on the other hand, handles the entire process end to end.</p><p>The &ldquo;Unix way&rdquo; would be to split each bit of functionality into individual scripts that can be chained together. The first program can then be executed as &ldquo;python3 analyze.py ~/blog/_posts out.csv && execute_sql {query}&rdquo; and the second as &ldquo;get_sql_field {get_max_date_query} | python3 get_health.py export.xml | execute_sql {query}&rdquo;. Neither of these feel particularly elegant since the commands feel bloated and not very easy to follow. There&rsquo;s also the mixture of SQL and CSV - how functional is a program that generates SQL but doesn&rsquo;t actually execute it? Is that really a self contained script?</p><p>It all goes to show that there are multiple ways of solving problems and there&rsquo;s rarely a single obvious solution. Solutions are meant to solve problems and every problem is unique. At the moment I&rsquo;m partial to having a personal library of common SQL that I can tap into - it&rsquo;s a middle ground between the two approaches and allows me to get some reusability.</p></div><div class=navigation><div class=row><div class="col-12 col-lg-6"><div class="mx-0 mx-md-4 mt-4 text-left"><a href=/2020/06/28/specify-versions-in-technical-blogging/>« Specify versions in technical blogging</a></div></div><div class="col-12 col-lg-6"><div class="mx-0 mx-md-4 mt-4 text-right"><a href=/2020/07/08/optimizing-aws-reservations/>Optimizing AWS reservations »</a></div></div></div></div></div></div></div></div><section id=comments><div class="py-3 content"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><div class=comments><script src=https://utteranc.es/client.js repo=dangoldin/blog.dangoldin.com-comments issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></div></div></div></div></div></section><div class="my-4 footer"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><hr></div></div><div class="row justify-content-center"><div class="col-sm-12 col-lg-2"><div class="mx-0 mx-md-4 site-copyright">© 2021 Dan Goldin</div></div><div class="col-sm-12 col-lg-6"><div class="mx-0 mx-md-4 site-social"><ul><li><a href=mailto:dan@dangoldin.com>Contact</a></li><li><a href=https://github.com/dangoldin target=_blank>GitHub</a></li><li><a href=https://twitter.com/dangoldin target=_blank>Twitter</a></li><li><a href=https://www.linkedin.com/in/dangoldin target=_blank>LinkedIn</a></li><li><a href=/index.xml class=mr-0>RSS</a></li></ul></div></div></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js defer></script><script>window.addEventListener('load',function(){hljs.initHighlighting();},true);</script></body></html>