







<!DOCTYPE html>
<html ⚡ lang="en">
  <head>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700' rel='stylesheet' type='text/css'>
  <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
  <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
  <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  <!-- TODO: Make this optional -->
  <script async custom-element="amp-vimeo" src="https://cdn.ampproject.org/v0/amp-vimeo-0.1.js"></script>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Analyzing IMDB data: Step 1 - Cleaning and QA</title>
  <meta name="description" content="I got my hands on a dump of IMDB data and wrote up the process required to get it into a state that's useful for analysis.">
  <meta name="keywords" content="sql, data analysis, imdb, movies, actors, actresses" />
  <meta name="author" content="Dan Goldin">

  <link rel="canonical" href="http://dangoldin.com/2016/05/21/analyzing-imdb-data-step-1-cleaning-and-qa/">
  <link rel="alternate" type="application/rss+xml" title="Dan Goldin" href="http://dangoldin.com/atom.xml">

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@dangoldin" />
  <meta name="twitter:title" content="Analyzing IMDB data: Step 1 - Cleaning and QA" />

  <meta property="og:type"                content="website" />
  <meta property="og:site_name"           content="Dan Goldin" />
  <meta property="og:url"                 content="http://dangoldin.com/2016/05/21/analyzing-imdb-data-step-1-cleaning-and-qa/" />
  <meta property="og:title"               content="Analyzing IMDB data: Step 1 - Cleaning and QA" />

  
  <meta property="og:description"         content="I got my hands on a dump of IMDB data and wrote up the process required to get it into a state that's useful for analysis." />
  <meta name="twitter:description"        content="I got my hands on a dump of IMDB data and wrote up the process required to get it into a state that's useful for analysis." />
  

  
  <meta property="og:image"               content="http://dangoldin.com/assets/static/images/imdb-data.png" />
  <meta name="twitter:image"              content="http://dangoldin.com/assets/static/images/imdb-data.png" />
  

  <link rel="shortcut icon" type="image/png" href="/favicon.png">

  <script type="application/ld+json">
  
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "http://dangoldin.com/2016/05/21/analyzing-imdb-data-step-1-cleaning-and-qa/",
  "headline": "Analyzing IMDB data: Step 1 - Cleaning and QA",
  "datePublished": "2016-05-21T00:00:00-04:00",
  "dateModified": "2016-05-21T00:00:00-04:00",
  "description": "In 2012 I did a simple analysis of IMDB to analyze the change in actor and actresses’s ages over time. At that point I limited the analysis to the top 50 mov...",
  "author": {
    "@type": "Person",
    "name": ""
  },
  "publisher": {
    "@type": "Organization",
    "name": "Dan Goldin",
    "logo": {
      "@type": "ImageObject",
      "url": "http://dangoldin.com",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://dangoldin.com",
    "height": 60,
    "width": 60
  }
}

  </script>

  <style amp-custom>
  
  /**
 * Syntax highlighting styles
 */
.highlight {
  background: #fff; }
  .highlighter-rouge .highlight {
    background: #eef; }
  .highlight .c {
    color: #998;
    font-style: italic; }
  .highlight .err {
    color: #a61717;
    background-color: #e3d2d2; }
  .highlight .k {
    font-weight: bold; }
  .highlight .o {
    font-weight: bold; }
  .highlight .cm {
    color: #998;
    font-style: italic; }
  .highlight .cp {
    color: #999;
    font-weight: bold; }
  .highlight .c1 {
    color: #998;
    font-style: italic; }
  .highlight .cs {
    color: #999;
    font-weight: bold;
    font-style: italic; }
  .highlight .gd {
    color: #000;
    background-color: #fdd; }
  .highlight .gd .x {
    color: #000;
    background-color: #faa; }
  .highlight .ge {
    font-style: italic; }
  .highlight .gr {
    color: #a00; }
  .highlight .gh {
    color: #999; }
  .highlight .gi {
    color: #000;
    background-color: #dfd; }
  .highlight .gi .x {
    color: #000;
    background-color: #afa; }
  .highlight .go {
    color: #888; }
  .highlight .gp {
    color: #555; }
  .highlight .gs {
    font-weight: bold; }
  .highlight .gu {
    color: #aaa; }
  .highlight .gt {
    color: #a00; }
  .highlight .kc {
    font-weight: bold; }
  .highlight .kd {
    font-weight: bold; }
  .highlight .kp {
    font-weight: bold; }
  .highlight .kr {
    font-weight: bold; }
  .highlight .kt {
    color: #458;
    font-weight: bold; }
  .highlight .m {
    color: #099; }
  .highlight .s {
    color: #d14; }
  .highlight .na {
    color: #008080; }
  .highlight .nb {
    color: #0086B3; }
  .highlight .nc {
    color: #458;
    font-weight: bold; }
  .highlight .no {
    color: #008080; }
  .highlight .ni {
    color: #800080; }
  .highlight .ne {
    color: #900;
    font-weight: bold; }
  .highlight .nf {
    color: #900;
    font-weight: bold; }
  .highlight .nn {
    color: #555; }
  .highlight .nt {
    color: #000080; }
  .highlight .nv {
    color: #008080; }
  .highlight .ow {
    font-weight: bold; }
  .highlight .w {
    color: #bbb; }
  .highlight .mf {
    color: #099; }
  .highlight .mh {
    color: #099; }
  .highlight .mi {
    color: #099; }
  .highlight .mo {
    color: #099; }
  .highlight .sb {
    color: #d14; }
  .highlight .sc {
    color: #d14; }
  .highlight .sd {
    color: #d14; }
  .highlight .s2 {
    color: #d14; }
  .highlight .se {
    color: #d14; }
  .highlight .sh {
    color: #d14; }
  .highlight .si {
    color: #d14; }
  .highlight .sx {
    color: #d14; }
  .highlight .sr {
    color: #009926; }
  .highlight .s1 {
    color: #d14; }
  .highlight .ss {
    color: #990073; }
  .highlight .bp {
    color: #999; }
  .highlight .vc {
    color: #008080; }
  .highlight .vg {
    color: #008080; }
  .highlight .vi {
    color: #008080; }
  .highlight .il {
    color: #099; }

.icon > svg {
  display: inline-block;
  width: 16px;
  height: 16px;
  vertical-align: middle; }
  .icon > svg path {
    fill: #828282; }

amp-img {
  background-color: grey; }

.cf:after {
  content: "";
  display: table;
  clear: both; }

main {
  display: block; }

body {
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif;
  margin: 0;
  padding: 0;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-font-feature-settings: "liga=1, dlig=1";
  -ms-font-feature-settings: "liga", "dlig";
  -webkit-font-feature-settings: "liga", "dlig";
  -o-font-feature-settings: "liga", "dlig";
  font-feature-settings: "liga", "dlig"; }

h1, h2, h3, h4, h5 {
  color: #222;
  font-weight: 300; }

h1 {
  font-size: 40px;
  line-height: 45px; }

h2 {
  font-size: 36px;
  line-height: 40px; }

h3 {
  font-size: 30px;
  line-height: 34px; }

h4 {
  font-size: 18px;
  line-height: 20px; }

h1 small {
  font-size: 20px;
  color: #666;
  font-weight: 300; }

li {
  font-size: 20px;
  line-height: 32px;
  padding-bottom: 8px; }

ul.tags {
  list-style: none outside;
  margin: 0;
  padding: 0;
  padding-top: 20px; }
  ul.tags li {
    display: inline;
    list-style-type: none;
    padding-right: 10px;
    font-size: 16px;
    line-height: 20px; }

.follow-footer {
  font-size: 16px;
  margin-top: 20px; }

[class^="icon-"], [class*=" icon-"] {
  display: inline-block; }

.main-content {
  margin-left: auto;
  margin-right: auto;
  max-width: 840px; }

.site-header {
  position: relative;
  width: 100%;
  max-width: 700px;
  margin: 16px auto 0 auto;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }
  @media only screen and (max-width: 700px) {
    .site-header {
      padding: 0 16px; } }

a {
  text-decoration: none;
  color: #06A; }
  a :visited {
    color: #607890; }
  a :hover {
    color: #005580; }

.avatar-section {
  display: flex;
  flex-direction: row; }
  .avatar-section #avatar {
    background-image: url("/assets/static/images/photo.jpg");
    background-size: cover;
    height: 154px;
    width: 154px;
    display: block;
    border-radius: 50%;
    margin-bottom: 8px;
    border: 2px solid #999;
    opacity: .8;
    -webkit-transition: all 500ms ease-in;
    -moz-transition: all 500ms ease-in;
    -o-transition: all 500ms ease-in;
    margin-left: 22px; }
  .avatar-section ul {
    list-style: none outside;
    margin-bottom: 20px; }
    .avatar-section ul li {
      line-height: 23px;
      font-family: 'Open Sans', sans-serif;
      font-weight: 300; }

#social li {
  display: inline-block;
  font-size: 22px;
  overflow: hidden; }
#social a, #social a:visited {
  color: #999;
  -webkit-transition: color 200ms ease-in;
  -moz-transition: color 200ms ease-in;
  -o-transition: color 200ms ease-in; }

a.icon-envelope {
  background: url("/assets/static/images/icons/webicon-mail.png");
  background-size: 20px 20px;
  width: 20px;
  height: 20px;
  margin-left: 5px; }

a.icon-glossi {
  background: url("/assets/static/images/icons/webicon-glossi.png");
  background-size: 20px 20px;
  width: 20px;
  height: 20px;
  margin-left: 5px; }

a.icon-github {
  background: url("/assets/static/images/icons/webicon-github.png");
  background-size: 20px 20px;
  width: 20px;
  height: 20px;
  margin-left: 5px; }

a.icon-twitter {
  background: url("/assets/static/images/icons/webicon-twitter.png");
  background-size: 20px 20px;
  width: 20px;
  height: 20px;
  margin-left: 5px; }

a.icon-linkedin {
  background: url("/assets/static/images/icons/webicon-linkedin.png");
  background-size: 20px 20px;
  width: 20px;
  height: 20px;
  margin-left: 5px; }

a.icon-feedly {
  background: url("/assets/static/images/icons/webicon-feedly.png");
  background-size: 20px 20px;
  width: 20px;
  height: 20px;
  margin-left: 5px; }

ul.posts, ol.posts {
  list-style: none outside;
  padding: 0;
  margin: 40px 25px 10px 25px; }
  ul.posts span.date, ol.posts span.date {
    text-align: right;
    color: #999;
    float: right;
    font-family: 'Gentium Book Basic', serif; }
  ul.posts li, ol.posts li {
    font-family: 'Open Sans', sans-serif;
    font-size: 21px;
    line-height: 32px;
    font-weight: 400; }

ul.thumbnails {
  list-style: none outside; }
  ul.thumbnails div.thumbnail {
    max-width: 700px; }

.content {
  width: 100%;
  max-width: 700px;
  margin: 25px auto 0 auto;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }
  @media only screen and (max-width: 700px) {
    .content {
      padding: 0 16px; } }
  .content article {
    padding: 10px 0;
    border-bottom: 1px solid #f2f2f0; }
    .content article:last-child {
      border-bottom: 0px; }
    .content article .post-title, .content article .page-title {
      letter-spacing: -0.02em;
      font-style: normal;
      display: block;
      font-size: 36px;
      line-height: 1.15;
      margin: 0 0; }
      .content article .post-title a, .content article .page-title a {
        text-decoration: none;
        color: #333332; }
        .content article .post-title a:hover, .content article .page-title a:hover {
          text-decoration: none; }
    .content article .post-meta, .content article .page-meta {
      font-size: 14px;
      color: #b3b3b1;
      line-height: 30px; }
      .content article .post-meta a, .content article .page-meta a {
        color: #b3b3b1;
        text-decoration: none; }
        .content article .post-meta a:hover, .content article .page-meta a:hover {
          text-decoration: underline; }

.pagination {
  text-align: center;
  padding: 16px 0 0;
  font-size: 12px; }
  .pagination a {
    color: #999999;
    text-decoration: none; }
    .pagination a:hover {
      color: #333333; }
  .pagination ul {
    display: inline-block;
    margin: 0; }
    .pagination ul li {
      display: inline; }

.site-footer {
  margin: 0 auto;
  padding: 48px 0;
  width: 100%;
  max-width: 700px;
  font-size: 12px;
  text-align: center;
  color: #999999;
  line-height: 17.6px; }
  .site-footer a {
    color: #666666;
    text-decoration: none; }
    .site-footer a:hover {
      color: #333333; }

.post .post-meta, .post .page-meta, .page .post-meta, .page .page-meta {
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
.post .post-title, .post .page-title, .page .post-title, .page .page-title {
  font-style: normal;
  letter-spacing: -0.04em;
  font-size: 50px;
  line-height: 1.1;
  color: #333332;
  margin-bottom: 50px; }
.post .post-meta-text, .post .page-meta-text, .page .post-meta-text, .page .page-meta-text {
  color: #b3b3b1;
  letter-spacing: -0.02em;
  font-style: normal;
  font-size: 14px;
  overflow: hidden;
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif;
  white-space: nowrap;
  text-overflow: ellipsis; }
.post .post-content, .post .page-content, .page .post-content, .page .page-content {
  width: 100%;
  font-family: Georgia, Cambria, "Times New Roman", Times, "Lora", serif;
  color: #333333; }
  .post .post-content h1, .post .post-content h2, .post .post-content h3, .post .page-content h1, .post .page-content h2, .post .page-content h3, .page .post-content h1, .page .post-content h2, .page .post-content h3, .page .page-content h1, .page .page-content h2, .page .page-content h3 {
    font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
  .post .post-content h3, .post .post-content h4, .post .post-content h5, .post .post-content h6, .post .page-content h3, .post .page-content h4, .post .page-content h5, .post .page-content h6, .page .post-content h3, .page .post-content h4, .page .post-content h5, .page .post-content h6, .page .page-content h3, .page .page-content h4, .page .page-content h5, .page .page-content h6 {
    letter-spacing: -0.02em;
    font-style: normal;
    font-size: 24px;
    line-height: 1.3;
    margin-top: 50px;
    margin-bottom: 0px;
    font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
  .post .post-content h1, .post .post-content h2, .post .page-content h1, .post .page-content h2, .page .post-content h1, .page .post-content h2, .page .page-content h1, .page .page-content h2 {
    letter-spacing: -0.02em;
    font-weight: 300;
    font-style: normal;
    font-size: 42px;
    line-height: 1.2;
    margin-top: 50px;
    margin-bottom: 0px; }
  .post .post-content h3, .post .page-content h3, .page .post-content h3, .page .page-content h3 {
    font-size: 30px;
    line-height: 34px;
    font-weight: 300; }
  .post .post-content p, .post .page-content p, .page .post-content p, .page .page-content p {
    font-weight: 400;
    font-style: normal;
    font-size: 22px;
    line-height: 1.59;
    letter-spacing: -.002em;
    margin-top: 30px;
    margin-bottom: 0;
    color: #333333;
    -webkit-hyphens: auto;
    -moz-hyphens: auto;
    hyphens: auto; }
    .post .post-content p.caption, .post .page-content p.caption, .page .post-content p.caption, .page .page-content p.caption {
      font-size: 18px;
      line-height: 1.2;
      margin-top: 2px;
      text-align: center;
      padding: 16px 40px 0 40px; }
  .post .post-content amp-img, .post .post-content amp-youtube, .post .page-content amp-img, .post .page-content amp-youtube, .page .post-content amp-img, .page .post-content amp-youtube, .page .page-content amp-img, .page .page-content amp-youtube {
    margin-top: 30px; }
  .post .post-content figure, .post .page-content figure, .page .post-content figure, .page .page-content figure {
    margin: 0;
    padding: 0; }
  .post .post-content figcaption, .post .page-content figcaption, .page .post-content figcaption, .page .page-content figcaption {
    font-weight: 400;
    font-style: italic;
    font-size: 16px;
    line-height: 1.3;
    color: #666665;
    outline: 0;
    z-index: 300;
    text-align: center; }
  .post .post-content hr, .post .page-content hr, .page .post-content hr, .page .page-content hr {
    border: 0;
    padding: 0;
    display: block;
    width: 15%;
    margin: 30px auto;
    border: 0px solid #dddddd;
    border-top: 1px solid #dddddd; }
  .post .post-content blockquote, .post .page-content blockquote, .page .post-content blockquote, .page .page-content blockquote {
    margin: 20px 0 20px;
    margin-left: -26px;
    border-left: 3px solid #57ad68;
    padding-left: 20px; }
    .post .post-content blockquote p, .post .page-content blockquote p, .page .post-content blockquote p, .page .page-content blockquote p {
      letter-spacing: 0.01rem;
      font-weight: 400;
      mborder-left: 3px solid #57ad68;
      mpadding-left: 20px;
      mmargin-left: -26px;
      padding-bottom: 3px;
      font-size: 20px;
      line-height: 1.3;
      padding-bottom: 10px; }
  .post .post-content ul, .post .post-content ol, .post .page-content ul, .post .page-content ol, .page .post-content ul, .page .post-content ol, .page .page-content ul, .page .page-content ol {
    padding: 0;
    margin: 10px 0 10px 25px; }
    .post .post-content ul.inline, .post .post-content ol.inline, .post .page-content ul.inline, .post .page-content ol.inline, .page .post-content ul.inline, .page .post-content ol.inline, .page .page-content ul.inline, .page .page-content ol.inline {
      margin-left: 0;
      list-style: none; }
      .post .post-content ul.inline li, .post .post-content ol.inline li, .post .page-content ul.inline li, .post .page-content ol.inline li, .page .post-content ul.inline li, .page .post-content ol.inline li, .page .page-content ul.inline li, .page .page-content ol.inline li {
        display: inline-block;
        padding-right: 5px;
        padding-left: 5px;
        margin: 0; }
        .post .post-content ul.inline li.dense, .post .post-content ol.inline li.dense, .post .page-content ul.inline li.dense, .post .page-content ol.inline li.dense, .page .post-content ul.inline li.dense, .page .post-content ol.inline li.dense, .page .page-content ul.inline li.dense, .page .page-content ol.inline li.dense {
          padding-top: 0;
          margin-bottom: 2px; }
    .post .post-content ul li, .post .post-content ol li, .post .page-content ul li, .post .page-content ol li, .page .post-content ul li, .page .post-content ol li, .page .page-content ul li, .page .page-content ol li {
      padding: 0;
      font-weight: 400;
      font-style: normal;
      font-size: 22px;
      line-height: 1.59;
      letter-spacing: -.002em;
      margin-left: 30px;
      margin-bottom: 2px;
      padding-top: 2px; }
      .post .post-content ul li p, .post .post-content ol li p, .post .page-content ul li p, .post .page-content ol li p, .page .post-content ul li p, .page .post-content ol li p, .page .page-content ul li p, .page .page-content ol li p {
        padding: 0 10px 0 10px; }
      .post .post-content ul li.dense, .post .post-content ol li.dense, .post .page-content ul li.dense, .post .page-content ol li.dense, .page .post-content ul li.dense, .page .post-content ol li.dense, .page .page-content ul li.dense, .page .page-content ol li.dense {
        padding-top: 0;
        margin-bottom: 2px; }
    .post .post-content ul.tag_box, .post .post-content ol.tag_box, .post .page-content ul.tag_box, .post .page-content ol.tag_box, .page .post-content ul.tag_box, .page .post-content ol.tag_box, .page .page-content ul.tag_box, .page .page-content ol.tag_box {
      padding-top: 10px; }
  .post .post-content ol li, .post .page-content ol li, .page .post-content ol li, .page .page-content ol li {
    list-style-type: decimal; }

.share {
  text-align: right;
  padding: 20px 0 0; }
  .share a {
    text-decoration: none;
    color: #bbbbbb;
    padding-left: 12px; }
    .share a .hidden {
      display: none; }
    .share a:hover {
      color: #333333; }

.right10 {
  float: right;
  padding-left: 10px;
  min-width: 250px; }

.video-holder {
  padding: 10px 0 10px 0; }

pre, code {
  font-size: 15px;
  border: 1px solid #e8e8e8;
  border-radius: 3px;
  background-color: #eeeeff; }

code {
  padding: 1px 5px; }

pre {
  padding: 8px 12px;
  overflow-x: scroll; }
  pre > code {
    border: 0;
    padding-right: 0;
    padding-left: 0; }

table {
  margin: 10px 0 10px 0;
  border-collapse: collapse; }
  table td {
    border-bottom: 1pt solid #eee;
    padding: 6px 2px 6px 2px;
    border-spacing: 6px; }

.pagination .disabled {
  opacity: 0; }

.comments {
  margin-top: 10px; }

  </style>

  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
  <script async src="https://cdn.ampproject.org/v0.js"></script>
</head>

  <body>
    <header class="site-header">
  <div class="avatar-section">
    <a id="avatar" href="/"></a>
    <div>
      <ul id="me">
        <li>Dan Goldin</li>
        <li class="gray">Engineering @ <a href="http://triplelift.com/">TripleLift</a></li>
      </ul>
      <ul id="social">
          <li>
            <a href="mailto:dangoldin@gmail.com?subject=Hey" class="icon-envelope" title="Say hi" id="link-email"></a>
          </li>
          <li>
            <a href="http://github.com/dangoldin" class="icon-github" title="I share and fork code here" id="link-github"></a>
          </li>
          <li>
            <a href="http://twitter.com/dangoldin" class="icon-twitter" title="You should follow me" id="link-twitter"></a>
          </li>
          <li>
            <a href="http://www.linkedin.com/in/dangoldin" class="icon-linkedin" title="My professional stuff here" id="link-linkedin"></a>
          </li>
          <li>
            <a href="http://www.feedly.com/home#subscription/feed%2Fhttp%3A%2F%2Fdangoldin.com%2Fatom.xml" class="icon-feedly" title="Subscribe via Feedly" id="link-feedly"></a>
          </li>
        </ul>
    </div>
    <ul>
      <li><a href="/about">About</a></li>
      <li><a href="/tags/">Tagged Posts</a></li>
    </ul>
  </div>
</header>


    







<main class="content" role="main">
  <article class="post">
    <div class="post-meta">
      <h1 class="post-title">Analyzing IMDB data: Step 1 - Cleaning and QA</h1>
      <span class="date">21 May 2016</span>
    </div>

    <section class="post-content">
      
<p>In 2012 I did a <a href="http://dangoldin.com/2012/05/23/trend-of-actor-vs-actress-age-differences/">simple analysis of IMDB</a> to analyze the change in actor and actresses’s ages over time. At that point I limited the analysis to the top 50 movies each decade and hacked together a quick script to crawl and scrape the IMDB analysis. A couple of weeks ago I came across a great <a href="https://www.curiousgnu.com/imdb-age-distribution">post by CuriousGnu</a> that did a similar analysis across a larger set of movies but limited to movies since 2000. I reached out and they were kind enough to give me a DigitalOcean instance containing the data already loaded into MySQL. The analysis should be finished up tomorrow but I wanted to write this post up to share the mundane parts of the process. The janitorial part is critically important to an analysis and it’s important to get it right or the results will may be meaningless or even completely wrong. The <a href="http://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html?_r=0">NY Times interviewed</a> a variety of data scientists and came away with the conclusion that 50 to 80 percent of a data scientist’s time is spent cleaning the data. This is no exception and I wanted to provide a sense of the effort and thought that goes into getting data into a state that’s actually useful.</p>

<div class="right10">
    <amp-img src="/assets/static/images/imdb-tables.png" alt="IMDB tables" width="203" height="459"></amp-img>
</div>

<p>Lucky for me I already had the data loaded and queryable in MySQL. Most of the time the data is scattered all over the place in a variety of different formats that require a slew of scripts to wrangle and manipulate the data into a useful format.</p>

<p>The first task was to get familiar with the data and I started by looking at sample rows from each of the tables. The table names were descriptive but it turned out that some of them were empty. Running a query that calculated the size of each provided a good idea of where the valuable data was - for my analysis the useful data lived in the title, name, cast_info, and person_info tables.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"> <span class="k">SELECT</span> <span class="k">TABLE_NAME</span><span class="p">,</span> <span class="n">table_rows</span><span class="p">,</span> <span class="n">data_length</span><span class="p">,</span> <span class="n">index_length</span><span class="p">,</span>
<span class="n">round</span><span class="p">(((</span><span class="n">data_length</span> <span class="o">+</span> <span class="n">index_length</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="nv">"Size in MB"</span>
<span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">TABLES</span> <span class="k">WHERE</span> <span class="n">table_schema</span> <span class="o">=</span> <span class="nv">"imdb"</span><span class="p">;</span></code></pre></figure>

<div class="right10">
    <amp-img src="/assets/static/images/imdb-data.png" alt="IMDB data" width="485" height="439" layout="responsive"></amp-img>
</div>

<p>The next step was figuring out the way the tables related to one another. Since the field names were obvious this was extremely straightforward. The only nuances came due to an unconventional naming scheme - for example the title table contains the list of movies but the other tables map to it via a movie_id column. Similarly, the name table contains people but it’s referenced via person_id in other tables. They key part here was starting with a movie I know and confirming that the results made sense. In my case I chose my favorite movie, The Rock, and made sure that the results of my query made sense.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="o">*</span>
<span class="k">from</span> <span class="n">title</span> <span class="n">t</span>
<span class="k">join</span> <span class="n">cast_info</span> <span class="n">ci</span> <span class="k">on</span> <span class="n">t</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">ci</span><span class="p">.</span><span class="n">movie_id</span>
<span class="k">join</span> <span class="n">name</span> <span class="n">n</span> <span class="k">on</span> <span class="n">ci</span><span class="p">.</span><span class="n">person_id</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="n">id</span>
<span class="k">where</span> <span class="n">t</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">3569260</span><span class="p">;</span></code></pre></figure>

<p>After getting a feel for the data it was time to actually think about the data necessary for the analysis. To see what was possible I examined the person_info table which contains a variety of information about each person - anywhere from birth and death dates, to spouse, to various names, to height. In my case looking at the birth and height gave me some ideas but I needed to extract these to make them useful. I ended up creating a table for each one and writing a series of queries to populate each one. This required looking at the format of the data in each of the rows and leveraging various combinations of the locate, substring, and cast commands to transform the text fields into something numeric. The birth date was straightforward since it came in two styles - one was just a year and the other was the full birth day with day and month.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">insert</span> <span class="k">into</span> <span class="n">person_birth</span>
    <span class="k">SELECT</span> <span class="n">person_id</span><span class="p">,</span> <span class="k">cast</span><span class="p">(</span><span class="n">info</span> <span class="k">as</span> <span class="n">UNSIGNED</span><span class="p">)</span>
    <span class="k">FROM</span> <span class="n">person_info</span>
    <span class="k">WHERE</span> <span class="n">info_type_id</span> <span class="o">=</span> <span class="mi">21</span>
    <span class="k">AND</span> <span class="k">length</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="c1">-- Birthdate is full date so just take the year</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">person_birth</span>
    <span class="k">SELECT</span> <span class="n">person_id</span><span class="p">,</span> <span class="k">cast</span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">unsigned</span><span class="p">)</span>
    <span class="k">FROM</span> <span class="n">person_info</span>
    <span class="k">WHERE</span> <span class="n">info_type_id</span> <span class="o">=</span> <span class="mi">21</span>
    <span class="k">AND</span> <span class="k">length</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">;</span></code></pre></figure>

<p>Height was a bit more difficult since it came in a variety of formats. Some were in centimeters, while others were in feet, while others were in feet and inches, with a small fraction having partial inches. Each of these required a complicated series of MySQL commands to convert to inches.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">insert</span> <span class="k">into</span> <span class="n">person_height</span>
    <span class="k">SELECT</span> <span class="n">person_id</span><span class="p">,</span> <span class="k">cast</span><span class="p">(</span><span class="k">replace</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">' cm'</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span> <span class="k">as</span> <span class="n">unsigned</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">393701</span>
    <span class="k">FROM</span> <span class="n">person_info</span>
    <span class="k">WHERE</span> <span class="n">info_type_id</span> <span class="o">=</span> <span class="mi">22</span>
    <span class="k">AND</span> <span class="n">info</span> <span class="k">like</span> <span class="s1">'%cm'</span><span class="p">;</span>

<span class="c1">-- No inches</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">person_height</span>
    <span class="k">SELECT</span> <span class="n">person_id</span><span class="p">,</span> <span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">12</span>
    <span class="k">FROM</span> <span class="n">person_info</span>
    <span class="k">WHERE</span> <span class="n">info_type_id</span> <span class="o">=</span> <span class="mi">22</span>
    <span class="k">AND</span> <span class="n">info</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'%cm'</span>
    <span class="k">AND</span> <span class="n">info</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'%/%'</span>
    <span class="k">AND</span> <span class="n">info</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'%"%'</span><span class="p">;</span>

<span class="c1">-- No fractional inches (would also work for no inches but playing it safe)</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">person_height</span>
    <span class="k">SELECT</span> <span class="n">person_id</span><span class="p">,</span> <span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'"'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">-</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">FROM</span> <span class="n">person_info</span>
    <span class="k">WHERE</span> <span class="n">info_type_id</span> <span class="o">=</span> <span class="mi">22</span>
    <span class="k">AND</span> <span class="n">info</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'%cm'</span>
    <span class="k">AND</span> <span class="n">info</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'%/%'</span>
    <span class="k">AND</span> <span class="n">info</span> <span class="k">like</span> <span class="s1">'%"%'</span><span class="p">;</span>

<span class="c1">-- Fractional inches</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">person_height</span>
    <span class="k">select</span> <span class="n">person_id</span><span class="p">,</span> <span class="k">cast</span><span class="p">(</span><span class="n">base_height</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">)</span> <span class="o">+</span> <span class="k">cast</span><span class="p">(</span><span class="n">numerator</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">)</span><span class="o">/</span><span class="k">cast</span><span class="p">(</span><span class="n">denominator</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">)</span>
    <span class="k">from</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">person_id</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'"'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">-</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'</span><span class="se">\'</span><span class="s1">'</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">base_height</span><span class="p">,</span>
        <span class="k">substring</span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">numerator</span><span class="p">,</span>
        <span class="k">substring</span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">locate</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">substring</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">locate</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="k">as</span> <span class="n">denominator</span>
        <span class="k">FROM</span> <span class="n">person_info</span>
        <span class="k">WHERE</span> <span class="n">info_type_id</span> <span class="o">=</span> <span class="mi">22</span>
        <span class="k">AND</span> <span class="n">info</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'%cm'</span>
        <span class="k">AND</span> <span class="n">info</span> <span class="k">like</span> <span class="s1">'%/%'</span>
        <span class="k">AND</span> <span class="n">info</span> <span class="k">like</span> <span class="s1">'%"%'</span>
    <span class="p">)</span> <span class="k">temp</span><span class="p">;</span></code></pre></figure>

<p>Finally it was time to dive into the data. The first query I decided to write was to look at the average age of actors and actresses by year. Writing the query and doing a quick explain caused me to add a few indices to improve the performance but even then it still took over 20 minutes to execute. Having used Vertica and Redshift in the past I knew a columnar database would help but I wanted to keep it free. This led me to <a href="https://www.monetdb.org/">MonetDB</a>.</p>

<p>Somewhat remarkably, installing and setting up MonetDB was a breeze but I had a two hiccups migrating the data. One was creating the equivalent tables in MonetDB which had a slightly different syntax from MySQL and required a bit of trial and error to work through. The other was the actual export of data from MySQL in a way that was also easy to load into MonetDB. I ended up settling on a CSV export that also took into account the various ways to delimit, escape, and enclose the different fields. After getting the migration to work on one table it was just a series of copy and pastes to get the other tables over.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">-- MySQL export</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">title</span> <span class="k">into</span> <span class="n">outfile</span> <span class="s1">'/tmp/title.csv'</span> <span class="n">fields</span> <span class="n">terminated</span> <span class="k">by</span> <span class="s1">','</span> <span class="n">enclosed</span> <span class="k">by</span> <span class="s1">'"'</span> <span class="n">escaped</span> <span class="k">by</span> <span class="nv">"</span><span class="se">\\</span><span class="nv">"</span> <span class="n">lines</span> <span class="n">terminated</span> <span class="k">by</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">;</span>

<span class="c1">-- MonetDB import</span>
<span class="k">COPY</span> <span class="k">INTO</span> <span class="n">title</span> <span class="k">from</span> <span class="s1">'/tmp/title.csv'</span> <span class="k">USING</span> <span class="k">DELIMITERS</span> <span class="s1">','</span><span class="p">,</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="s1">'"'</span> <span class="k">NULL</span> <span class="k">AS</span> <span class="s1">'</span><span class="se">\\</span><span class="s1">N'</span><span class="p">;</span></code></pre></figure>

<p>I had no experience with MonetDB and didn’t know what to expect with this entire series of steps being a waste of time. I expected some improvement and it turns out the query that took over 20 minutes to run in MySQL was able to run in just over 30 seconds in MonetDB. I was off to the races. I spent the next bit of time QAing the data and dealing with outliers and edge cases. Some were due to mistakes I made - for example not filtering cast members to only include actors and actresses which manifested itself in an actor that lived to be over 2000 years old. This turned out to be a movie about <a href="http://www.imdb.com/title/tt1560702/">Socrates</a> with one of the writers being Plato. Some simply uncovered weird data - there’s a movie, <a href="http://www.imdb.com/title/tt5174640/">100 Years</a>, which is scheduled to be released in 2115 and led to some old actors and actresses. While others were clearly data mistakes - actors who were born after they died, for example <a href="http://www.imdb.com/name/nm2917761/">Walter Beck</a> who was born in 1988 but passed away in 1964.</p>

<amp-img src="/assets/static/images/100-years.png" alt="100 Years" width="644" height="360" layout="responsive"></amp-img>

<amp-img src="/assets/static/images/walter-beck.png" alt="Walter Beck" width="661" height="243" layout="responsive"></amp-img>

<p>Dealing with these was an iterative process. I ended up settling on removing all non actors and actresses from the queries as well as limiting my dataset to movies produced between 1920 and 2015 while also eliminating all combinations where a movie was produced before a birth. These edge cases are infrequent enough that they most likely wouldn’t have had any impact on the results but going through this process gives us confidence in what we’re doing. The next step is actually going through the analysis which I hope to finish up tomorrow.</p>

<p>If you’re interested in the code, it’s up on <a href="https://github.com/dangoldin/imdb">GitHub</a>; and if you’re interested in the data contact me and I can share a snapshot of the DigitalOcean instance that contains the data in both MySQL and MonetDB.</p>

    </section>

    
    <div>
      <ul class="tags">
        <li>Tagged under:</li>
      
      


  <!-- <li>Tagged under:</li> -->
  
    
    	<!-- <li><a href="/tags/##sql-ref">#sql <span>13</span></a></li> -->
      <li><a href="/tags/##sql-ref">#sql </a></li>
    
    	<!-- <li><a href="/tags/##code-ref">#code <span>109</span></a></li> -->
      <li><a href="/tags/##code-ref">#code </a></li>
    
    	<!-- <li><a href="/tags/##data-ref">#data <span>18</span></a></li> -->
      <li><a href="/tags/##data-ref">#data </a></li>
    
  



      </ul>
    </div><br/>
    

    <div class="follow-footer">
      Liked this post? Follow me on Twitter <a href="https://twitter.com/dangoldin">here</a>.
    </div>

    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2016/05/15/experimenting-with-medium/" title="Experimenting with Medium">&larr; Prev</a> | </li>
      
        <li><a href="/archive/">Archive</a></li>
      
        <li class="next"> | <a href="/2016/05/22/analyzing-imdb-data-actors-vs-actresses/" title="Analyzing IMDB data: Actors vs actresses">Next &rarr;</a></li>
      
      </ul>
    </div>

    <div class="comments">
      <amp-iframe
        height="300"
        sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"
        resizable
        frameborder="0"
        src="https://s3.amazonaws.com/dangoldin.com/amp-disqus.html?url=http%3A%2F%2Fdangoldin.com%2F2016%2F05%2F21%2Fanalyzing-imdb-data-step-1-cleaning-and-qa%2F&title=Analyzing+IMDB+data%3A+Step+1+-+Cleaning+and+QA">
        <div overflow tabindex="0" role="button" aria-label="Read more">Read more!</div>
      </amp-iframe>
    </div>

  </article>
</main>

<footer class="site-footer">
  <div class="inner">
    <section class="copyright">All content copyright <a href="mailto:"></a> &copy; 2017 &bull; All rights reserved.</section>
    <section class="poweredby">Made with <a href="http://jekyllrb.com"> Jekyll</a> and <a href="https://github.com/ageitgey/amplify">Amplify</a>. Theme inspired by <a href="http://sirupsen.com/">Simon Hørup Eskildsen</a>.</section>
  </div>
</footer>

<amp-analytics type="googleanalytics" id="analytics1">
<script type="application/json">
{
  "vars": {
    "account": "UA-36313127-1"
  },
  "triggers": {
    "trackPageview": {
      "on": "visible",
      "request": "pageview"
    },
    "trackClickOnEmail" : {
      "on": "click",
      "selector": "#link-email",
      "request": "event",
      "vars": {
        "socialNetwork": "email",
        "socialAction": "email",
        "socialTarget": "mailto:dangoldin@gmail.com?subject=Hey"
      }
    },
    "trackClickOnEmail" : {
      "on": "click",
      "selector": "#link-github",
      "request": "event",
      "vars": {
        "socialNetwork": "github",
        "socialAction": "github",
        "socialTarget": "https://github.com/dangoldin"
      }
    },
    "trackClickOnEmail" : {
      "on": "click",
      "selector": "#link-twitter",
      "request": "event",
      "vars": {
        "socialNetwork": "twitter",
        "socialAction": "twitter",
        "socialTarget": "https://twitter.com/dangoldin"
      }
    },
    "trackClickOnEmail" : {
      "on": "click",
      "selector": "#link-linkedin",
      "request": "event",
      "vars": {
        "socialNetwork": "linkedin",
        "socialAction": "linkedin",
        "socialTarget": "http://www.linkedin.com/in/dangoldin"
      }
    },
    "trackClickOnEmail" : {
      "on": "click",
      "selector": "#link-feedly",
      "request": "event",
      "vars": {
        "socialNetwork": "feedly",
        "socialAction": "feedly",
        "socialTarget": "http://www.feedly.com/home#subscription/feed%2Fhttp%3A%2F%2Fdangoldin.com%2Fatom.xml"
      }
    }
  }
}
</script>
</amp-analytics>


  </body>
</html>

