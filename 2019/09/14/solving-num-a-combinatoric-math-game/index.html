<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title> Solving Num: A combinatoric math game - Dan Goldin </title>
<meta name=HandheldFriendly content="True">
<meta name=MobileOptimized content="320">
<meta name=referrer content="no-referrer">
<meta name=description content="My approach to solving Num - a combinatoric math game where you have to combine numbers and operations to get to a desired value.">
<meta property="og:site_name" content="Dan Goldin">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:url" content="/2019/09/14/solving-num-a-combinatoric-math-game/">
<meta property="og:title" content="Solving Num: A combinatoric math game">
<meta property="og:image" content="//image/num-level-68-solution.png">
<meta property="og:description" content="My approach to solving Num - a combinatoric math game where you have to combine numbers and operations to get to a desired value.">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:site content="@dangoldin">
<meta name=twitter:creator content="@dangoldin">
<meta name=twitter:title content="Solving Num: A combinatoric math game">
<meta name=twitter:description content="My approach to solving Num - a combinatoric math game where you have to combine numbers and operations to get to a desired value.">
<meta name=twitter:image content="//image/num-level-68-solution.png">
<link rel=canonical href=/2019/09/14/solving-num-a-combinatoric-math-game/>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin=anonymous>
<link rel=stylesheet href=https://nanx-assets.netlify.app/fonts.css>
<link rel=stylesheet href=/css/custom.css>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github-gist.min.css integrity="sha512-od7JLoOTxM8w/HSKGzP9Kexc20K9p/M2zxSWsd7H1e4Ctf+8SQFtCWEZnW5u6ul5ehSECa5QmOk9ju2nQMmlVA==" crossorigin=anonymous>
<link rel="shortcut icon" href=/favicon.png>
<link href=/index.xml rel=alternate type=application/rss+xml title="Dan Goldin">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36313127-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-36313127-1')</script>
</head>
<body>
<div class="my-4 my-lg-5 header">
<div class=container>
<div class=row>
<div class="col-auto offset-lg-2 d-none d-lg-block">
<a href=/>
<img class="ml-lg-4 logo img-fluid d-block rounded-circle" src=/image/photo.jpg alt=logo>
</a>
</div>
<div class="col-auto align-self-center mr-auto">
<a href=/>
<h1 class=name>Dan Goldin</h1>
</a>
<ul class="nav nav-primary">
<li class=nav-item>
<a class="nav-link text-home" href=/>
Home
</a>
</li>
<li class=nav-item>
<a class="nav-link text-about" href=/about/>
About
</a>
</li>
<li class=nav-item>
<a class="nav-link text-lore" href=/lore/>
Lore
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class=content>
<div class=container>
<div class="row justify-content-center">
<div class="col-sm-12 col-lg-8">
<h1 class="mx-0 mx-md-4 blog-post-title">Solving Num: A combinatoric math game</h1>
<div class="mb-md-4 meta">
<span class="date middot" title="Sat Sep 14 2019 00:00:00 UTC">
2019-09-14
</span>
<span class="reading-time middot">
4 min read
</span>
<div class="d-none d-md-inline tags">
<ul class="list-unstyled d-inline">
<li class="d-inline middot">
<a href=/tags/code>code</a>
</li>
</ul>
</div>
<div class="d-none d-md-inline tags">
<ul class="list-unstyled d-inline">
</ul>
</div>
</div>
<div class="markdown blog-post-content">
<p><img src=/image/num-level-68-combined.png alt="Num puzzle unsolved and solved" data-width=1108 data-height=985 data-layout=responsive></p>
<p>I don&rsquo;t play games on my phone but one game I keep going back to is &ldquo;<a href=https://apps.apple.com/us/app/num-insanely-hard-math-game/id861791129>Num</a>&rdquo; - an &ldquo;insanely hard math game.&rdquo; The premise is pretty simple - you have a few numbers that you need to combine, using the four basic math operations, so it computes to a specific number.</p>
<p>The levels start off simple but it gets more difficult with a lot of trial and error at the higher levels. They&rsquo;re no longer simple expressions that can be evaluated fairly linearly but instead are solved by using fairly complex intermediate values.</p>
<p>I enjoy the process of solving these problems but decided to challenge myself to write a program that can solve these sorts of problems. Last night I was able to get a crude solution working that&rsquo;s able to solve a 6-number problem in about 5 minutes on my laptop. The next challenge is speeding this to be even quicker but even the crude solution took a few attempts to get right.</p>
<p>The approach I took was a somewhat intelligent brute force. While it&rsquo;s still fresh I wanted to share the attempts to highlight my thought process and the difficulties with each failed attempt.</p>
<h3 id=attempt-1>Attempt 1</h3>
<p>Idea here was to simply get all the number permutations and alternate them with all combinations of the operators - for example &ldquo;1 + 4 - 5 * 6 / 4 + 1&rdquo; - and then run them through Python&rsquo;s eval to see how far I could get. I knew full well this would not solve all types of problems due to not being able to control the order of operations but I just wanted to get a starting point.</p>
<h3 id=attempt-2>Attempt 2</h3>
<p>At this point I wanted to handle the order of operations issue from the first attempt and figured it would be easier to do that if I switched to a <a href=https://en.wikipedia.org/wiki/Reverse_Polish_notation>Reverse Polish Notation</a> (RPN). The intuition here was to simplify the expressions I&rsquo;d need to generate by not having to worry about the parentheses. This required implementing an RPN evaluator but I found a <a href=https://blog.klipse.tech/python/2016/09/22/python-reverse-polish-evaluator.html>simple one online</a>. Similar to the first attempt, this approach was still not able to represent every type of expression but it was much easier to work with. An example of an expression generated with this approach is &ldquo;1 2 9 8 17 3 / + * - *&rdquo;.</p>
<h3 id=attempt-3>Attempt 3</h3>
<p>This was an extremely brute force attempt by treating each combination of numbers and operators as its own expression to be permuted. I didn&rsquo;t worry about validation and instead just relied on evaluating and then ignoring the exceptions. The permutation step was incredibly simple to implement but as expected this was extremely inefficient and I was unable to actually get a solution in a reasonable amount of time. An example of an expression generated (invalid) with this approach was &ldquo;1 + * 2 9 8 17 3 / - *&rdquo; - it had the right numbers and operators but the RPN order was just invalid.</p>
<h3 id=attempt-4>Attempt 4</h3>
<p>This was simply validating the expressions generated in the third attempt to before running the evaluator. With RPN the approach is incredibly simple since all we need to do is read from left to right and make sure that the number of numbers seen is always greater than the number of operators. This is the current approach and actually results in a working solution in a reasonable amount of time. I tested it on a few problems that have 6 starting numbers and the solutions were all within the 5 to 10 minute range.</p>
<h3 id=future>Future</h3>
<p>There are some clear deficiencies with the previous approach. The major one is that why validate instead of generating the valid expressions at the beginning? The ideal approach would also do a fair amount of memoization to avoid having to recompute the same sub-expressions over and over. I expect that implementing these ideas will improve the speed by an order of magnitude.</p>
<p>If you&rsquo;re interested in following along or building your own implementation it&rsquo;s all available on GitHub: <a href=https://github.com/dangoldin/num-game-solver/blob/master/solve.py>https://github.com/dangoldin/num-game-solver/blob/master/solve.py</a>.</p>
</div>
<div class=navigation>
<div class=row>
<div class="col-12 col-lg-6">
<div class="mx-0 mx-md-4 mt-4 text-left">
<a href=/2019/09/13/in-praise-of-tcpdump/>« In praise of tcpdump</a>
</div>
</div>
<div class="col-12 col-lg-6">
<div class="mx-0 mx-md-4 mt-4 text-right">
<a href=/2019/09/15/google-sheets-explore-functionality/>Google Sheets explore functionality »</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<section id=comments>
<div class="py-3 content">
<div class=container>
<div class="row justify-content-center">
<div class="col-sm-12 col-lg-8">
<div class=comments>
<script src=https://utteranc.es/client.js repo=dangoldin/blog.dangoldin.com-comments issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script>
</div>
</div>
</div>
</div>
</div>
</section>
<div class="my-4 footer">
<div class=container>
<div class="row justify-content-center">
<div class="col-sm-12 col-lg-8">
<hr>
</div>
</div>
<div class="row justify-content-center">
<div class="col-sm-12 col-lg-2">
<div class="mx-0 mx-md-4 site-copyright">
© 2021 Dan Goldin
</div>
</div>
<div class="col-sm-12 col-lg-6">
<div class="mx-0 mx-md-4 site-social">
<ul>
<li><a href=mailto:dan@dangoldin.com>Contact</a></li>
<li><a href=https://github.com/dangoldin target=_blank>GitHub</a></li>
<li><a href=https://twitter.com/dangoldin target=_blank>Twitter</a></li>
<li><a href=https://www.linkedin.com/in/dangoldin target=_blank>LinkedIn</a></li>
<li><a href=/index.xml class=mr-0>RSS</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js defer></script>
<script>window.addEventListener('load',function(){hljs.initHighlighting()},!0)</script>
</body>
</html>