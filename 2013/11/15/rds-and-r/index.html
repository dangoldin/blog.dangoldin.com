<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>RDS and R - Dan Goldin</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=referrer content="no-referrer"><meta name=description content="Quick way to connect to an RDS instance using R through an SSH tunnel"><meta property="og:site_name" content="Dan Goldin"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="/2013/11/15/rds-and-r/"><meta property="og:title" content="RDS and R"><meta property="og:image" content="/image/photo.jpg"><meta property="og:description" content="Quick way to connect to an RDS instance using R through an SSH tunnel"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@dangoldin"><meta name=twitter:creator content="@dangoldin"><meta name=twitter:title content="RDS and R"><meta name=twitter:description content="Quick way to connect to an RDS instance using R through an SSH tunnel"><meta name=twitter:image content="/image/photo.jpg"><link rel=canonical href=/2013/11/15/rds-and-r/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin=anonymous><link rel=stylesheet href=https://nanx-assets.netlify.app/fonts.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github-gist.min.css integrity="sha512-od7JLoOTxM8w/HSKGzP9Kexc20K9p/M2zxSWsd7H1e4Ctf+8SQFtCWEZnW5u6ul5ehSECa5QmOk9ju2nQMmlVA==" crossorigin=anonymous><link rel="shortcut icon" href=/favicon.png><link href=/index.xml rel=alternate type=application/rss+xml title="Dan Goldin"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-36313127-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-36313127-1')</script></head><body><div class="my-4 my-lg-5 header"><div class=container><div class=row><div class="col-auto offset-lg-2 d-none d-lg-block"><a href=/><img class="ml-lg-4 logo img-fluid d-block rounded-circle" src=/image/photo.jpg alt=logo></a></div><div class="col-auto align-self-center mr-auto"><a href=/><h1 class=name>Dan Goldin</h1></a><ul class="nav nav-primary"><li class=nav-item><a class="nav-link text-home" href=/>Home</a></li><li class=nav-item><a class="nav-link text-about" href=/about/>About</a></li><li class=nav-item><a class="nav-link text-lore" href=/lore/>Lore</a></li></ul></div></div></div></div><div class=content><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><h1 class="mx-0 mx-md-4 blog-post-title">RDS and R</h1><div class="mb-md-4 meta"><span class="date middot" title="Fri Nov 15 2013 00:00:00 UTC">2013-11-15</span>
<span class="reading-time middot">1 min read</span><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"><li class="d-inline middot"><a href=/tags/r>R</a></li><li class="d-inline middot"><a href=/tags/sql>sql</a></li><li class="d-inline middot"><a href=/tags/code>code</a></li><li class="d-inline middot"><a href=/tags/aws>aws</a></li></ul></div><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"></ul></div></div><div class="markdown blog-post-content"><p>In my quest to replace Excel with R I’ve been spending the past week trying to do everything in R. It hasn’t been that easy with many things taking longer due to me having to reference the R docs but one thing that’s been great so far is being able to quickly run a query on Amazon’s RDS and pull data into a data frame for quick analysis. Being able to wrap this into a reusable function makes things even better. The one thing that makes it tricky was not being able to connect to RDS directly but having to tunnel through an EC2 instance. Below are the steps to replicate the setup.</p><p>In your shell, run the following command to set up the SSH tunnel:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ssh -L &lt;local port&gt;:&lt;rds host&gt;:&lt;rds port&gt;&lt;ec2 user&gt;@&lt;ec2 instance&gt;</code></pre></div></p><p>Now in R:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=color:#a6e22e>install.packages</span>(‘RMySQL’) <span style=color:#75715e># Install the R MySQL library</span>
<span style=color:#a6e22e>library</span>(RMySQL) <span style=color:#75715e># Load the library</span>
m<span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>dbDriver</span>(<span style=color:#e6db74>&#34;MySQL&#34;</span>) <span style=color:#75715e># Load the driver</span>
con<span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>dbConnect</span>(m,user<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;username&#39;</span>,password<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;pass&#39;</span>,host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;127.0.0.1&#39;</span>,dbname<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;db&#39;</span>,port<span style=color:#f92672>=</span><span style=color:#ae81ff>3307</span>) <span style=color:#75715e># Connect to the local instance</span>
res<span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>dbSendQuery</span>(con, <span style=color:#e6db74>&#39;select * from table&#39;</span>) <span style=color:#75715e># Execute the query</span>
data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>fetch</span>(res, n <span style=color:#f92672>=</span> <span style=color:#ae81ff>-1</span>) <span style=color:#75715e># Load the retrieved data into a data frame</span>
<span style=color:#a6e22e>dbClearResult</span>(<span style=color:#a6e22e>dbListResults</span>(con)[[1]]) <span style=color:#75715e># Use this to free the connection</span></code></pre></div></p></div><div class=navigation><div class=row><div class="col-12 col-lg-6"><div class="mx-0 mx-md-4 mt-4 text-left"><a href=/2013/11/09/is-excel-on-a-mac-intentionally-hobbled/>« Is Excel on a Mac intentionally hobbled?</a></div></div><div class="col-12 col-lg-6"><div class="mx-0 mx-md-4 mt-4 text-right"><a href=/2013/11/16/a-twitter-flashback/>A Twitter flashback »</a></div></div></div></div></div></div></div></div><section id=comments><div class="py-3 content"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><div class=comments><script src=https://utteranc.es/client.js repo=dangoldin/blog.dangoldin.com-comments issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></div></div></div></div></div></section><div class="my-4 footer"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><hr></div></div><div class="row justify-content-center"><div class="col-sm-12 col-lg-2"><div class="mx-0 mx-md-4 site-copyright">© 2021 Dan Goldin</div></div><div class="col-sm-12 col-lg-6"><div class="mx-0 mx-md-4 site-social"><ul><li><a href=mailto:dan@dangoldin.com>Contact</a></li><li><a href=https://github.com/dangoldin target=_blank>GitHub</a></li><li><a href=https://twitter.com/dangoldin target=_blank>Twitter</a></li><li><a href=https://www.linkedin.com/in/dangoldin target=_blank>LinkedIn</a></li><li><a href=/index.xml class=mr-0>RSS</a></li></ul></div></div></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js defer></script><script>window.addEventListener('load',function(){hljs.initHighlighting()},!0)</script></body></html>